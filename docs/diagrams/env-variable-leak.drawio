<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2026-02-09T00:00:00.000Z" agent="Claude" version="24.0.0" type="device">
  <diagram id="env-variable-leak" name="環境変数の漏洩経路">
    <mxGraphModel dx="900" dy="750" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="860" pageHeight="680" math="0" shadow="0" background="#FFFFFF">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- タイトル -->
        <mxCell id="title" value="環境変数の漏洩経路" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=20;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="290" y="15" width="220" height="40" as="geometry" />
        </mxCell>

        <!-- 外枠 -->
        <mxCell id="outer" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=2;arcSize=4;" vertex="1" parent="1">
          <mxGeometry x="40" y="65" width="780" height="590" as="geometry" />
        </mxCell>

        <!-- 中央: 環境変数ボックス -->
        <mxCell id="center" value="環境変数&#xa;(API_KEY, DB_PASSWORD, ...)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;strokeWidth=2;fontSize=13;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="290" y="85" width="240" height="55" as="geometry" />
        </mxCell>

        <!-- 漏洩経路1: docker inspect -->
        <mxCell id="l1-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;arcSize=10;" vertex="1" parent="1">
          <mxGeometry x="70" y="180" width="720" height="80" as="geometry" />
        </mxCell>
        <mxCell id="l1-num" value="1" style="ellipse;whiteSpace=wrap;html=1;fillColor=#b85450;strokeColor=#b85450;fontColor=#ffffff;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="200" width="35" height="35" as="geometry" />
        </mxCell>
        <mxCell id="l1-title" value="docker inspect で確認可能" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=13;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="140" y="195" width="210" height="25" as="geometry" />
        </mxCell>
        <mxCell id="l1-desc" value="docker inspect コマンドで全環境変数が平文で表示される" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="225" width="380" height="20" as="geometry" />
        </mxCell>
        <mxCell id="l1-warn" value="危険" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="720" y="205" width="50" height="20" as="geometry" />
        </mxCell>

        <!-- 漏洩経路2: docker history -->
        <mxCell id="l2-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;arcSize=10;" vertex="1" parent="1">
          <mxGeometry x="70" y="280" width="720" height="80" as="geometry" />
        </mxCell>
        <mxCell id="l2-num" value="2" style="ellipse;whiteSpace=wrap;html=1;fillColor=#b85450;strokeColor=#b85450;fontColor=#ffffff;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="300" width="35" height="35" as="geometry" />
        </mxCell>
        <mxCell id="l2-title" value="docker history でビルド引数が見える" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=13;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="140" y="295" width="290" height="25" as="geometry" />
        </mxCell>
        <mxCell id="l2-desc" value="ARG で渡した値がイメージの履歴に残り、誰でも参照できる" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="325" width="400" height="20" as="geometry" />
        </mxCell>
        <mxCell id="l2-warn" value="危険" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="720" y="305" width="50" height="20" as="geometry" />
        </mxCell>

        <!-- 漏洩経路3: ログ出力 -->
        <mxCell id="l3-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;arcSize=10;" vertex="1" parent="1">
          <mxGeometry x="70" y="380" width="720" height="80" as="geometry" />
        </mxCell>
        <mxCell id="l3-num" value="3" style="ellipse;whiteSpace=wrap;html=1;fillColor=#b85450;strokeColor=#b85450;fontColor=#ffffff;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="400" width="35" height="35" as="geometry" />
        </mxCell>
        <mxCell id="l3-title" value="ログ出力" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=13;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="140" y="395" width="80" height="25" as="geometry" />
        </mxCell>
        <mxCell id="l3-desc" value="アプリケーションのデバッグログに環境変数が出力される場合がある" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="425" width="430" height="20" as="geometry" />
        </mxCell>
        <mxCell id="l3-warn" value="危険" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="720" y="405" width="50" height="20" as="geometry" />
        </mxCell>

        <!-- 漏洩経路4: プロセス一覧 -->
        <mxCell id="l4-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;arcSize=10;" vertex="1" parent="1">
          <mxGeometry x="70" y="480" width="720" height="80" as="geometry" />
        </mxCell>
        <mxCell id="l4-num" value="4" style="ellipse;whiteSpace=wrap;html=1;fillColor=#b85450;strokeColor=#b85450;fontColor=#ffffff;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="500" width="35" height="35" as="geometry" />
        </mxCell>
        <mxCell id="l4-title" value="プロセス一覧 (/proc/[pid]/environ)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=13;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="140" y="495" width="280" height="25" as="geometry" />
        </mxCell>
        <mxCell id="l4-desc" value="ホスト上の /proc ファイルシステムからプロセスの環境変数が読み取れる" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="140" y="525" width="460" height="20" as="geometry" />
        </mxCell>
        <mxCell id="l4-warn" value="危険" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="720" y="505" width="50" height="20" as="geometry" />
        </mxCell>

        <!-- 漏洩経路5: コアダンプ -->
        <mxCell id="l5-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;strokeWidth=2;arcSize=10;" vertex="1" parent="1">
          <mxGeometry x="70" y="580" width="720" height="60" as="geometry" />
        </mxCell>
        <mxCell id="l5-num" value="5" style="ellipse;whiteSpace=wrap;html=1;fillColor=#b85450;strokeColor=#b85450;fontColor=#ffffff;fontSize=16;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="90" y="592" width="35" height="35" as="geometry" />
        </mxCell>
        <mxCell id="l5-title" value="コアダンプ・デバッグ情報" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=13;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
          <mxGeometry x="140" y="592" width="210" height="25" as="geometry" />
        </mxCell>
        <mxCell id="l5-desc" value="クラッシュ時のコアダンプにメモリ上の環境変数が含まれる" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="360" y="595" width="380" height="20" as="geometry" />
        </mxCell>
        <mxCell id="l5-warn" value="危険" style="text;html=1;align=right;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;fontStyle=1;fontColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="720" y="595" width="50" height="20" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
